# ğŸ” Microsoft 365 Developer Program ë° Azure AD ì„¤ì • ê°€ì´ë“œ

Azure AD ì•± ë“±ë¡ ê¶Œí•œì´ ì—†ëŠ” ê²½ìš° ë¬´ë£Œ ê°œë°œì í…Œë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

## ğŸ¯ Microsoft 365 Developer Program (ì¶”ì²œ!)

**ì™„ì „ ë¬´ë£Œ**ë¡œ ì‹¤ì œ SharePoint Onlineê³¼ Graph APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì¥ì 
- âœ… 90ì¼ ë¬´ë£Œ (í™œë™ ì‹œ ìë™ ì—°ì¥)
- âœ… 25ê°œ ì‚¬ìš©ì ë¼ì´ì„ ìŠ¤
- âœ… SharePoint Online í¬í•¨
- âœ… ìƒ˜í”Œ ë°ì´í„° ìë™ ìƒì„±
- âœ… ì™„ì „í•œ ê´€ë¦¬ì ê¶Œí•œ
- âœ… ì‹¤ì œ í”„ë¡œë•ì…˜ê³¼ ë™ì¼í•œ í™˜ê²½

---

## ğŸ“ ë‹¨ê³„ë³„ ì„¤ì • ê°€ì´ë“œ

### Step 1: Developer Program ê°€ì…

1. **ì›¹ì‚¬ì´íŠ¸ ì ‘ì†**
   ```
   https://developer.microsoft.com/en-us/microsoft-365/dev-program
   ```

2. **"Join now" í´ë¦­**

3. **Microsoft ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸**
   - ê°œì¸ ê³„ì • ì‚¬ìš© (Outlook.com, Hotmail.com ë“±)
   - íšŒì‚¬ ê³„ì •ì´ ì•„ë‹Œ ê°œì¸ ê³„ì • ê¶Œì¥

4. **í”„ë¡œí•„ ì •ë³´ ì…ë ¥**
   - Country/Region: South Korea
   - Company: ê°œì¸ ë˜ëŠ” íšŒì‚¬ëª…
   - ì‚¬ìš© ëª©ì : Learning / Development

### Step 2: ìƒŒë“œë°•ìŠ¤ í™˜ê²½ ìƒì„±

1. **"Set up E5 subscription" ì„ íƒ**

2. **ê´€ë¦¬ì ê³„ì • ìƒì„±**
   ```
   Username: admin (ë˜ëŠ” ì›í•˜ëŠ” ì´ë¦„)
   Domain: yourname.onmicrosoft.com (ê³ ìœ í•œ ì´ë¦„ ì„ íƒ)
   Password: ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ì„¤ì •
   ```
   
   ì˜ˆì‹œ: `admin@myragspo.onmicrosoft.com`

3. **âœ… "Add sample data packs" ì˜µì…˜ ì²´í¬**
   - SharePoint ì‚¬ì´íŠ¸ì™€ ë¬¸ì„œê°€ ìë™ ìƒì„±ë©ë‹ˆë‹¤!
   - ë©”ì¼, íŒ€ì¦ˆ, ì‚¬ìš©ì ë“± í…ŒìŠ¤íŠ¸ ë°ì´í„° í¬í•¨

4. **ìƒì„± ëŒ€ê¸°** (ì•½ 5-10ë¶„)

5. **ì™„ë£Œ!** 
   - í…Œë„ŒíŠ¸ ì •ë³´ í™•ì¸
   - ê´€ë¦¬ì í¬í„¸ ë§í¬ ì €ì¥

### Step 3: Azure Portal ì ‘ì†

1. **Azure Portal ì—´ê¸°**
   ```
   https://portal.azure.com/
   ```

2. **ìœ„ì—ì„œ ë§Œë“  ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸**
   ```
   admin@yourname.onmicrosoft.com
   ```

### Step 4: Azure AD ì•± ë“±ë¡

1. **Azure Active Directoryë¡œ ì´ë™**
   - ì™¼ìª½ ë©”ë‰´ì—ì„œ "Azure Active Directory" í´ë¦­
   - ë˜ëŠ” ê²€ìƒ‰ì°½ì— "Azure Active Directory" ì…ë ¥

2. **ì•± ë“±ë¡ ë©”ë‰´**
   - ì™¼ìª½ ë©”ë‰´ì—ì„œ "ì•± ë“±ë¡(App registrations)" í´ë¦­
   - "ìƒˆ ë“±ë¡(New registration)" í´ë¦­

3. **ì•± ì •ë³´ ì…ë ¥**
   ```
   ì´ë¦„: RAG-SPO-Backend
   ì§€ì›ë˜ëŠ” ê³„ì • ìœ í˜•: ì´ ì¡°ì§ ë””ë ‰í„°ë¦¬ì˜ ê³„ì •ë§Œ
   ë¦¬ë””ë ‰ì…˜ URI: (ë¹„ì›Œë‘ )
   ```

4. **"ë“±ë¡" í´ë¦­**

### Step 5: ì•± ID í™•ì¸

ì•±ì´ ìƒì„±ë˜ë©´ "ê°œìš”(Overview)" í˜ì´ì§€ì—ì„œ:

```
ì• í”Œë¦¬ì¼€ì´ì…˜(í´ë¼ì´ì–¸íŠ¸) ID: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
ë””ë ‰í„°ë¦¬(í…Œë„ŒíŠ¸) ID: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
```

ğŸ“‹ **ë©”ëª¨ì¥ì— ë³µì‚¬í•´ë‘ì„¸ìš”!**

### Step 6: í´ë¼ì´ì–¸íŠ¸ ì‹œí¬ë¦¿ ìƒì„±

1. **ì™¼ìª½ ë©”ë‰´ì—ì„œ "ì¸ì¦ì„œ ë° ë¹„ë°€" í´ë¦­**

2. **"í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€" íƒ­ ì„ íƒ**

3. **"+ ìƒˆ í´ë¼ì´ì–¸íŠ¸ ì•”í˜¸" í´ë¦­**

4. **ì •ë³´ ì…ë ¥**
   ```
   ì„¤ëª…: RAG-SPO Backend Secret
   ë§Œë£Œ: 24ê°œì›” (ê¶Œì¥)
   ```

5. **"ì¶”ê°€" í´ë¦­**

6. **âš ï¸ ì¤‘ìš”! ì¦‰ì‹œ "ê°’(Value)" ë³µì‚¬**
   ```
   ê°’: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   ```
   - **ì§€ê¸ˆ ë³µì‚¬í•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œ ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!**
   - ë©”ëª¨ì¥ì— ì•ˆì „í•˜ê²Œ ì €ì¥

### Step 7: API ê¶Œí•œ ë¶€ì—¬ â­

1. **ì™¼ìª½ ë©”ë‰´ì—ì„œ "API ê¶Œí•œ" í´ë¦­**

2. **"+ ê¶Œí•œ ì¶”ê°€" í´ë¦­**

3. **"Microsoft Graph" ì„ íƒ**

4. **"ì• í”Œë¦¬ì¼€ì´ì…˜ ê¶Œí•œ(Application permissions)" ì„ íƒ**
   - âŒ "ìœ„ì„ëœ ê¶Œí•œ" ì•„ë‹˜!

5. **í•„ìš”í•œ ê¶Œí•œ ê²€ìƒ‰ ë° ì²´í¬**
   
   ê²€ìƒ‰: `Sites`
   - âœ… `Sites.Read.All` ì²´í¬
   
   ê²€ìƒ‰: `Files`
   - âœ… `Files.Read.All` ì²´í¬

6. **"ê¶Œí•œ ì¶”ê°€" í´ë¦­**

7. **â­ ê´€ë¦¬ì ë™ì˜ í—ˆìš©**
   - "... ì— ëŒ€í•œ ê´€ë¦¬ì ë™ì˜ í—ˆìš©" ë²„íŠ¼ í´ë¦­
   - "ì˜ˆ" í´ë¦­
   - ìƒíƒœê°€ ë…¹ìƒ‰ ì²´í¬ í‘œì‹œë¡œ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸

### Step 8: .env íŒŒì¼ ì„¤ì •

`backend/.env` íŒŒì¼ ìƒì„± ë° ì…ë ¥:

```env
# ë°ëª¨ ëª¨ë“œ ë¹„í™œì„±í™” (ì‹¤ì œ SharePoint ì‚¬ìš©)
DEMO_MODE=False

# Step 5ì—ì„œ ë³µì‚¬í•œ ê°’ë“¤
TENANT_ID=ë³µì‚¬í•œ-í…Œë„ŒíŠ¸-ID
CLIENT_ID=ë³µì‚¬í•œ-í´ë¼ì´ì–¸íŠ¸-ID
CLIENT_SECRET=ë³µì‚¬í•œ-í´ë¼ì´ì–¸íŠ¸-ì‹œí¬ë¦¿

# SharePoint Site ID (ì•„ë˜ì—ì„œ í™•ì¸)
SHAREPOINT_SITE_ID=

# Qdrant ì„¤ì •
QDRANT_HOST=localhost
QDRANT_PORT=6333
QDRANT_COLLECTION_NAME=spo_docs

# Embedding ì„¤ì •
EMBEDDING_MODEL=text-embedding-3-small
EMBEDDING_DIMENSION=1536

# Chunking ì„¤ì •
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
```

---

## ğŸ” SharePoint Site ID ì°¾ê¸°

### âš¡ ìë™ ìƒì„±ë˜ëŠ” ê²ƒë“¤

Microsoft 365 Developer Programì—ì„œ **"ìƒ˜í”Œ ë°ì´í„° í¬í•¨"** ì„ íƒ ì‹œ:

| í•­ëª© | ìë™ ìƒì„±? | ì¡°íšŒ ë°©ë²• |
|------|-----------|----------|
| SharePoint ì‚¬ì´íŠ¸ | âœ… ìë™ ìƒì„± | ë¸Œë¼ìš°ì €ë¡œ ì ‘ì† ê°€ëŠ¥ |
| ìƒ˜í”Œ ë¬¸ì„œ | âœ… ìë™ ìƒì„± | ì‚¬ì´íŠ¸ì—ì„œ í™•ì¸ ê°€ëŠ¥ |
| **Site ID** | âŒ ìˆ˜ë™ ì¡°íšŒ í•„ìš” | ì•„ë˜ ë°©ë²• ì‚¬ìš© |

### ë°©ë²• 1: Python ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© (ê°€ì¥ ì‰¬ì›€! â­)

**ìš°ë¦¬ê°€ ë§Œë“  ë„êµ¬ ì‚¬ìš©:**

```bash
cd backend

# 1. .env íŒŒì¼ì— Azure AD ì •ë³´ ì…ë ¥ (DEMO_MODE=False)
# 2. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
python scripts/get_site_id.py
```

**ì¶œë ¥ ì˜ˆì‹œ:**
```
ğŸ” SharePoint Site ID ì¡°íšŒ ë„êµ¬
================================================

âœ… ì´ 2ê°œì˜ ì‚¬ì´íŠ¸ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.

ì‚¬ì´íŠ¸ #1: Communication site
ğŸ”‘ Site ID: yourname.sharepoint.com,abc123...,def456...
ğŸŒ URL: https://yourname.sharepoint.com/sites/contoso
ğŸ“ ì„¤ëª…: Sample communication site

ğŸ’¡ ì¶”ì²œ
ì²« ë²ˆì§¸ ì‚¬ì´íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤:

.env íŒŒì¼ì— ë‹¤ìŒê³¼ ê°™ì´ ì¶”ê°€í•˜ì„¸ìš”:
SHAREPOINT_SITE_ID=yourname.sharepoint.com,abc123...,def456...
```

**íŠ¹ì • ì‚¬ì´íŠ¸ë§Œ ì¡°íšŒ:**
```bash
python scripts/get_site_id.py /sites/contoso
```

### ë°©ë²• 2: Graph Explorer ì‚¬ìš© (ì›¹ ë¸Œë¼ìš°ì €)

1. **Graph Explorer ì—´ê¸°**
   ```
   https://developer.microsoft.com/en-us/graph/graph-explorer
   ```

2. **ê°œë°œì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸**
   ```
   admin@yourname.onmicrosoft.com
   ```

3. **ê¶Œí•œ ë™ì˜**
   - "Modify permissions" í´ë¦­
   - `Sites.Read.All` ì²´í¬ í›„ ë™ì˜

4. **ì‚¬ì´íŠ¸ ëª©ë¡ ì¡°íšŒ**
   ```
   GET https://graph.microsoft.com/v1.0/sites?search=*
   ```

5. **"Run query" í´ë¦­**

6. **ì‘ë‹µì—ì„œ `id` ë³µì‚¬**
   ```json
   {
     "value": [
       {
         "id": "yourname.sharepoint.com,12345678-1234...",
         "displayName": "Communication site",
         "webUrl": "https://yourname.sharepoint.com/sites/contoso"
       }
     ]
   }
   ```

### ë°©ë²• 3: PowerShell ì‚¬ìš© (Windows)

```powershell
# 1. í† í° ë°œê¸‰
$tenantId = "your-tenant-id"
$clientId = "your-client-id"
$clientSecret = "your-client-secret"

$body = @{
    client_id     = $clientId
    scope         = "https://graph.microsoft.com/.default"
    client_secret = $clientSecret
    grant_type    = "client_credentials"
}

$tokenResponse = Invoke-RestMethod -Method Post `
    -Uri "https://login.microsoftonline.com/$tenantId/oauth2/v2.0/token" `
    -Body $body

$token = $tokenResponse.access_token

# 2. ì‚¬ì´íŠ¸ ëª©ë¡ ì¡°íšŒ
$headers = @{
    Authorization = "Bearer $token"
}

$sites = Invoke-RestMethod -Method Get `
    -Uri "https://graph.microsoft.com/v1.0/sites?search=*" `
    -Headers $headers

# 3. ì‚¬ì´íŠ¸ ì •ë³´ ì¶œë ¥
$sites.value | ForEach-Object {
    Write-Host "ì‚¬ì´íŠ¸: $($_.displayName)"
    Write-Host "Site ID: $($_.id)"
    Write-Host "URL: $($_.webUrl)"
    Write-Host ""
}
```

---

## âœ… ì„¤ì • í™•ì¸

### 1. í† í° ë°œê¸‰ í…ŒìŠ¤íŠ¸

PowerShellì—ì„œ:

```powershell
$tenantId = "your-tenant-id"
$clientId = "your-client-id"
$clientSecret = "your-client-secret"

$body = @{
    client_id     = $clientId
    scope         = "https://graph.microsoft.com/.default"
    client_secret = $clientSecret
    grant_type    = "client_credentials"
}

$response = Invoke-RestMethod -Method Post -Uri "https://login.microsoftonline.com/$tenantId/oauth2/v2.0/token" -Body $body

$response.access_token
```

ì„±ê³µí•˜ë©´ ê¸´ í† í° ë¬¸ìì—´ì´ ì¶œë ¥ë©ë‹ˆë‹¤!

### 2. Graph API í˜¸ì¶œ í…ŒìŠ¤íŠ¸

```powershell
$token = $response.access_token
$headers = @{
    Authorization = "Bearer $token"
}

Invoke-RestMethod -Method Get -Uri "https://graph.microsoft.com/v1.0/sites" -Headers $headers
```

ì‚¬ì´íŠ¸ ëª©ë¡ì´ ì¶œë ¥ë˜ë©´ ì„±ê³µ! ğŸ‰

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

ì„¤ì •ì´ ì™„ë£Œë˜ë©´:

1. âœ… `backend/.env` íŒŒì¼ í™•ì¸
2. âœ… Qdrant ì‹¤í–‰
3. âœ… ì•± ì‹¤í–‰: `python -m app.main`
4. âœ… ì¸ë±ì‹±: `python scripts/run_indexing.py`
5. âœ… ê²€ìƒ‰ í…ŒìŠ¤íŠ¸: `python scripts/test_search.py`

---

## â“ FAQ

### Q1: Developer Program ê³„ì •ì´ ë§Œë£Œë˜ë‚˜ìš”?
A: 90ì¼ í›„ ìë™ ë§Œë£Œë˜ì§€ë§Œ, **í™œë™ì´ ìˆìœ¼ë©´ ìë™ ì—°ì¥**ë©ë‹ˆë‹¤!
- API í˜¸ì¶œ
- ë¡œê·¸ì¸
- í…Œë„ŒíŠ¸ ì‚¬ìš©

### Q2: ì‹¤ì œ í”„ë¡œë•ì…˜ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‚˜ìš”?
A: Developer Programì€ **ê°œë°œ ë° í…ŒìŠ¤íŠ¸ ì „ìš©**ì…ë‹ˆë‹¤.
- í”„ë¡œë•ì…˜: íšŒì‚¬ ê³„ì • ë˜ëŠ” ìœ ë£Œ Microsoft 365 ì‚¬ìš©

### Q3: ìƒ˜í”Œ ë°ì´í„°ëŠ” ì–´ë””ì— ìˆë‚˜ìš”?
A: SharePoint ì‚¬ì´íŠ¸ëŠ” ìë™ ìƒì„±ë©ë‹ˆë‹¤:
```
https://yourname.sharepoint.com/sites/contoso
```

### Q4: ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤
A: ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:
1. API ê¶Œí•œì—ì„œ "ê´€ë¦¬ì ë™ì˜" í—ˆìš©í–ˆëŠ”ì§€
2. ì• í”Œë¦¬ì¼€ì´ì…˜ ê¶Œí•œ (ìœ„ì„ëœ ê¶Œí•œ ì•„ë‹˜)
3. í† í° ì¬ë°œê¸‰

### Q5: íšŒì‚¬ ê³„ì •ìœ¼ë¡œ ê°€ì…í–ˆëŠ”ë° ê¶Œí•œì´ ì—†ì–´ìš”
A: ê°œì¸ Microsoft ê³„ì •(Outlook.com)ìœ¼ë¡œ ìƒˆë¡œ ê°€ì…í•˜ì„¸ìš”!

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Microsoft 365 Developer Program](https://developer.microsoft.com/microsoft-365/dev-program)
- [Graph API ì¸ì¦ ë¬¸ì„œ](https://learn.microsoft.com/en-us/graph/auth-v2-service)
- [Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer)
- [Azure AD ì•± ë“±ë¡](https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app)

---

## ğŸ†˜ ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”?

ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. DEMO_GUIDE.mdì˜ ë°ëª¨ ëª¨ë“œë¡œ ë¨¼ì € í…ŒìŠ¤íŠ¸
2. GitHub Issuesì— ì§ˆë¬¸ ë‚¨ê¸°ê¸°
3. Microsoft Learn Q&A ì»¤ë®¤ë‹ˆí‹° í™œìš©

ì¦ê±°ìš´ ê°œë°œ ë˜ì„¸ìš”! ğŸš€

